# 片上资源/外设

## 1 概述

*Peripheral*, /pəˈrɪfərəl/，称为外设或片上资源。外设是学习stm32的最主要的内容，即通过程序配置外设完成需要的功能。



## 2 常见外设（stm32f1系列）

| 英文缩写 | 名称                           | 英文缩写 | 名称               |
| -------- | ------------------------------ | -------- | ------------------ |
| NVIC     | 嵌套向量中断控制器（内核外设） | CAN      | CAN通信            |
| SysTick  | 系统滴答定时器（内核外设）     | USB      | USB通信            |
| RCC      | 复位和时钟控制                 | RTC      | 实时时钟           |
| GPIO     | 通用IO口                       | CRC      | CRC校验            |
| AFIO     | 复用IO口                       | PWR      | 电源控制           |
| EXTI     | 外部中断                       | BKP      | 备份寄存器         |
| TIM      | 定时器                         | IWDG     | 独立看门狗         |
| ADC      | 模数转换器                     | WWDG     | 窗口看门狗         |
| DMA      | 直接内存访问                   | DAC      | 数模转换器         |
| USART    | 同步/异步串口通信              | SDIO     | SD卡接口           |
| I2C      | I2C通信                        | FSMC     | 可变静态存储控制器 |
| SPI      | SPI通信                        | USB OTG  | USB主机接口        |

- **NVIC**

  内核中用于管理中断的设备，如配置中断优先级

- **SysTick**

  内核中的定时器，用于给操作系统提供定时服务。stm32可以加入FreeRTOS、UCOS等操作系统，如果使用了这些操作系统，就需要SysTick提供定时来进行任务切换的功能。此外，还可以使用此定时器完成Delay函数的功能。

- **RCC**

  可以对系统的时钟进行配置，以及使能各模块的时钟。在stm32中，众多外设在上电的情况下默认没有时钟，此时操作外设无效，外设不工作，这种设计的目的是降低功耗。***所以，在操作外设之前必须先使用RCC使能对应外设的时钟***。

- **GPIO**

  单片机最基本的功能，可用来点灯、读取按键等。

- **AFIO**

  用于复用功能端口的重定义，以及中断端口的配置

- **EXTI**

  当外部中断配置完成后，若引脚电平发生变化，将触发中断

- **TIM**

  stm32最常用、功能最多的外设。TIM分为高级定时器、通用定时器、基本定时器三种类型。定时器可以完成定时中断任务，还可以完成测频率、生成PWM波形（电机驱动、舵机驱动）、配置成专用的编码器接口等功能。

- **ADC**

  用于直接读取IO口的模拟电压值，无需外部连接AD芯片，使用便捷。

- **DMA**

  直接内存访问，可以帮助CPU完成搬运大量数据的繁杂任务。

- **USART**

  USART是同步或异步串口（即同时支持异步串口和同步串口），UART是异步串口（实际使用更多）。

- **I2C、SPI**

  通信协议，stm32内置了协议的控制器，可以使用硬件输出时序波形，更高效。也可以用通用IO口模拟时序波形。

- **CAN、USB**

  通信协议，CAN通信一般用于汽车领域。利用stm32的USB外设，可以制作模拟鼠标、键盘等设备。

- **RTC**

  实时时钟，在stm32内部完成年月日、时分秒的计时功能。可以接外部备用电池，即使掉电也能正常运行。

- **CRC**

  一种数据的校验方式，用于判断数据的正确性。通过此外设的支持，进行CRC校验会更加方便。

- **PWR**

  电源控制，可以让芯片进入睡眠模式等状态以达到省电的模式。

- **BKP**

  备份存储器，当系统掉电时，仍可由备份电池保持数据，完成一些特殊功能。

- **IWDG、WWDG**

  看门狗，当单片机因为电磁干扰死机或程序设计不合理出现死循环时，看门狗可以及时复位芯片，保证系统的稳定。

- **DAC**

  数模转换器，可以在IO口直接输出模拟电压，为ADC的逆过程。

- **SDIO**

  SD卡接口，用来读取SD卡

- **FSMC**

  可变静态存储控制器，用于扩展内存，或配置成其他总线协议，用于某些硬件的操作。

- **USB OTG**

  USB主机接口，可以让stm32作为USB主机去读取其他USB设备。

