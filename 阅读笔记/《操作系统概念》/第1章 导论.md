# 第1章 导论

**概述**

操作系统是硬件与用户之间的中介程序，**目的**是为用户提供方便且有效地执行程序的环境。

操作系统每一部分都是构造好的系统的一部分，并严格定义了**输入、输出和功能**。

## 1.1 操作系统做什么

计算机系统分为硬件和软件，软件包括操作系统、系统程序、应用程序。

操作系统本身并不能实现任何有用的功能，**只不过**提供了一个方便其他程序做有用工作的环境。

### 1.1.1 用户视角

不同的使用情况强调不同的用户观点。

### 1.1.2 系统视角

操作系统是控制程序，控制程序管理用户程序的执行以防止计算机资源的错误或不当使用。特别关注I/O设备的操作和控制。

### 1.1.3 定义操作系统

计算机系统的基本目的是执行用户程序并能更容易地解决用户问题（图灵机模型）。

不同的应用程序，共同的控制和分配I/O设备资源的功能集合组成了一个软件模块----操作系统。

操作系统是一直运行在计算机上的程序（通常称为**内核**），其他程序则称为系统程序和应用程序。

## 1.2 计算机系统组织

### 1.2.1 计算机系统操作

现代计算机系统如图：

<img src="./images/uint1/现代计算机系统.png" style="zoom:40%;" />



**启动**

首先运行**引导程序**（booststrap program, 位于ROM中）。引导程序是计算机硬件中的固件，用于初始化系统的所有部分，包括CPU寄存器、设备控制器和内存内容。

然后，引导程序定位操作系统内核并将其装入内存，开始执行系统。

最后，操作系统开始执行第一个进程如init，并等待事件的发生。



**中断**

硬件和软件都能触发中断，用于表示事件的发生。

CPU中断发生时，CPU暂停正在做的事并转移到**中断服务程序**的首地址开始执行中断服务程序。



### 1.2.2 存储结构

设备存储层次如下图：

<img src="./images/uint1/设备存储层次.png" style="zoom:67%;" />

一个典型指令执行周期首先从内存中获取指令，并保存到**指令寄存器**，然后对指令解码，并可能导致从内存中获取操作数或将操作数保存在内部寄存器中。在指令完成对操作数的执行后，其结果可以存回到内存。



### 1.2.3 I/O结构

存储器只是众多I/O设备的一种。

通用计算机系统由一个CPU和多个**设备控制器**组成，他们通过共同的总线连接起来。每个设备控制器负责特定类型的设备，可有多个设备与其相连。



**设备控制器**

设备控制器维护一定量的**本地缓冲存储**和一组**特定用途的寄存器**。设备控制器控制其其负责的外部设备与本次缓冲存储之间的数据传递。操作系统为每个设备控制器提供一个设备驱动程序。



**设备驱动层序**

设备驱动层序理解设备控制器，并提供设备与操作系统的统一接口。

为了开始I/O操作，设备驱动程序在设备控制器中装载适当的寄存器，设备控制器检查这些寄存器的内容以决定采取什么操作。然后控制器开始从所管理的设备向本地缓冲区传输数据，完成后通过中断通知设备驱动程序其已完成操作。然后设备驱动程序返回对操作系统的控制，如返回数据或数据指针，或状态信息。

I/O中断驱动适合移动少量数据。DMA（直接内存访问）适合大块数据移动。DMA中，设备控制器能在本地缓冲和内存之间传送一整块数据而无需CPU的干预。



## 1.3 计算机体系结构

### 1.3.1 单处理器系统



### 1.3.2 多处理器系统



### 1.3.3 集群系统



## 1.4 操作系统结构



## 1.5 操作系统操作

### 1.5.1 双重模式操作



### 1.5.2 定时器



### 1.6 进程管理



## 1.7 内存管理



## 1.8 存储管理

### 1.8.1 文件系统管理



### 1.8.2 大容量存储器管理



### 1.8.3 高速缓存



### 1.8.4 I/O系统



## 1.9 保护和安全



## 1.10 分布式系统



## 1.11 专用系统

### 1.11.1 实时嵌入式系统



### 1.11.2 多媒体系统



### 1.11.3 手持系统



## 1.12 计算环境

### 1.12.1 传统计算



### 1.12.2 客户机-服务器计算



### 1.12.3 对等计算



### 1.12.4 基于Web的计算











