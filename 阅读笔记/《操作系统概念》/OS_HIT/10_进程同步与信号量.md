**进程同步**

需要让进程“走走停停”来保证多进程合作的合理有序。



**信号在进程同步时存在的问题**

*多个生产者*因等待资源而睡眠，而消费者在有空闲资源时发信号唤醒生产者。消费者一个信号只能唤醒一个生产者，但消费者不知道有多少生产者需要被唤醒。



**信号量**

一种特殊整型变量，信号用来睡眠和唤醒，量用来记录。

```c++
struct semaphore
{
    int value; //记录资源个数
    PCB *queue; //记录等待在该信号量上的进程
}
P (semaphore s) //消费资源
{
    s.value--;
    if (s.value < 0) {
        sleep(s.queue);
    }
}
V (semaphore s) //产生资源
{
    s.value++;
    if (s.value <= 0) {
        wakeup(s.queue);
    }
}
```

